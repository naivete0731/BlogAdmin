"use strict";(self["webpackChunkblog_admin"]=self["webpackChunkblog_admin"]||[]).push([[412],{9412:function(e,t,n){n.r(t),n.d(t,{default:function(){return d}});var r=function(){var e=this,t=e._self._c;return t("div",[t("el-card",[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("span",[e._v("侧边栏管理")]),t("el-button",{staticClass:"btn-pub",attrs:{type:"parimar",size:"small"},on:{click:e.AddMenu}},[e._v("添加侧边栏")])],1),t("el-table",{staticStyle:{width:"100%","margin-bottom":"20px"},attrs:{data:e.menus,"row-key":"_id",border:"","default-expand-all":"",lazy:"","tree-props":{children:"items",hasChildren:"hasChildren"}}},[t("el-table-column",{attrs:{prop:"title",label:"菜单名",sortable:"",width:"180"}}),t("el-table-column",{attrs:{prop:"icon",label:"图标",sortable:"",width:"180"},scopedSlots:e._u([{key:"default",fn:function({row:n}){return[t("i",{class:n.icon}),t("span",[e._v(e._s(n.icon))])]}}])}),t("el-table-column",{attrs:{prop:"createAt",label:"日期"},scopedSlots:e._u([{key:"default",fn:function({row:t}){return[e._v(" "+e._s(e.$formatDate(t.createAt))+" ")]}}])}),t("el-table-column",{attrs:{prop:"indexPath",label:"路由地址"}}),t("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function({row:n}){return[t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.editMenu(n._id)}}},[e._v("编辑")]),t("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(t){return e.delMenu(n._id)}}},[e._v("删除")])]}}])})],1)],1),t("el-drawer",{attrs:{title:"添加侧边栏",visible:e.drawer,"before-close":e.handleClose,direction:"rtl",size:"50%"},on:{"update:visible":function(t){e.drawer=t}}},[t("div",[t("el-form",{ref:"MenuFormRef",attrs:{model:e.MenuForm,rules:e.MenuFormRules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"菜单名称",prop:"title"}},[t("el-input",{attrs:{placeholder:"请输入菜单名称"},model:{value:e.MenuForm.title,callback:function(t){e.$set(e.MenuForm,"title",t)},expression:"MenuForm.title"}})],1),t("el-form-item",{attrs:{label:"图标",prop:"icon"}},[t("el-input",{attrs:{placeholder:"请选择图标"},model:{value:e.MenuForm.icon,callback:function(t){e.$set(e.MenuForm,"icon",t)},expression:"MenuForm.icon"}}),t("el-button",{on:{click:function(t){e.innerDrawer=!0}}},[e._v("点击选择图标")])],1),t("el-form-item",{attrs:{label:"路由地址",prop:"indexPath"}},[t("el-input",{attrs:{placeholder:"请输入路由地址"},model:{value:e.MenuForm.indexPath,callback:function(t){e.$set(e.MenuForm,"indexPath",t)},expression:"MenuForm.indexPath"}})],1),t("el-form-item",{attrs:{label:"菜单项"}},[e.SecondaryMenu?e._e():t("el-button",{on:{click:function(t){e.SecondaryMenu=!0}}},[e._v("创建二级菜单")]),e.SecondaryMenu?t("el-select",{attrs:{placeholder:"请选择父级菜单",size:"small"},model:{value:e.MenuForm.parentMenuId,callback:function(t){e.$set(e.MenuForm,"parentMenuId",t)},expression:"MenuForm.parentMenuId"}},e._l(e.menus,(function(e){return t("el-option",{key:e._id,attrs:{label:e.title,value:e._id}})})),1):e._e()],1),t("el-form-item",[t("el-button",{on:{click:function(t){e.drawer=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.AddMenuFn()}}},[e._v("确 定")])],1)],1),t("el-drawer",{attrs:{title:"图标","append-to-body":!0,direction:"rtl",visible:e.innerDrawer},on:{"update:visible":function(t){e.innerDrawer=t}}},[t("Icon")],1)],1)])],1)},i=[],a=n(7877),s=n(7808),o={name:"AsideSetting",components:{Icon:s.Z},data(){return{menus:[],drawer:!1,innerDrawer:!1,MenuForm:{title:"",icon:"",indexPath:"",parentMenuId:""},MenuFormRules:{title:[{required:!0,message:"请输入菜单名称",trigger:"blur"},{pattern:/^\S{1,10}$/,message:"分类名必须是1-10位的非空字符",trigger:"blur"}],icon:[{required:!0,message:"请选择图标",trigger:"blur"},{pattern:/^[a-zA-Z0-9-_]{1,55}$/,message:"图标非法",trigger:"blur"}],indexPath:[{required:!0,message:"请输入路由地址",trigger:"blur"},{min:5,max:20,message:"路由超出限制",trigger:"blur"}]},SecondaryMenu:!1,isEdit:!1}},created(){this.getMenuList()},methods:{async getMenuList(){const{data:e}=await(0,a.rJ)();if(200!==e.status)return this.$message.error("侧边栏获取失败");this.menus=e.data},async delMenu(e){const t=await this.$confirm("此操作将导致管理员数据丢失, 是否继续？","提示",{confirmButtonText:"确定",cancelButtonClass:"取消",type:"warning"}).catch((e=>e));if("confirm"===t){const{data:t}=await(0,a.yo)(e);if(200!==t.status)return this.$notify.error(t.message);this.getMenuList(),this.$notify.success("删除成功")}},handleClose(e){this.$confirm("确认关闭？").then((t=>{this.$refs.MenuFormRef.resetFields(),this.MenuForm={title:"",icon:"",indexPath:"",parentMenuId:""},this.SecondaryMenu=!1,e()})).catch((e=>{}))},AddMenu(){this.drawer=!0,this.isEdit=!1},async AddMenuFn(){this.$refs.MenuFormRef.validate((async e=>{if(!e)return this.$notify.error("校验未通过");if(this.isEdit){const{data:e}=await(0,a._8)(this.MenuForm);if(200!==e.status)return this.$notify.error(e.message);this.$notify.success(e.message),this.drawer=!1,this.$refs.MenuFormRef.resetFields(),this.MenuForm={title:"",icon:"",indexPath:"",parentMenuId:""},this.getMenuList()}else{const{data:e}=await(0,a.CL)(this.MenuForm);if(201!==e.status)return this.$notify.error(e.message);this.$notify.success(e.message),this.getMenuList()}}))},async editMenu(e){const{data:t}=await(0,a.xN)(e);if(200!==t.status)return this.$notify.error(t.message);this.MenuForm=t.data,this.drawer=!0,this.isEdit=!0,""!==this.MenuForm.parentMenuId&&(this.SecondaryMenu=!0)}}},l=o,u=n(1001),c=(0,u.Z)(l,r,i,!1,null,"62526495",null),d=c.exports}}]);
//# sourceMappingURL=412.cdef5084.js.map